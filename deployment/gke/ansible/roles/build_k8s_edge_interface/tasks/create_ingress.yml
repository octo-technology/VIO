---
- name: Create ingress for edge-interface
  kubernetes.core.k8s:
    state: present
    definition:
      apiVersion: networking.k8s.io/v1
      kind: Ingress
      metadata:
        name: "{{ app }}-ingress"
        namespace: "{{ namespace }}"
        annotations:
          ingress.kubernetes.io/ingress.allow-http: "false"
          kubernetes.io/ingress.regional-static-ip-name: "{{ tf_front_static_ip_name }}" # check for global/regional
          networking.gke.io/managed-certificates: "{{ tf_managed_cert }}"
      spec:
        defaultBackend:
          service:
            name: "{{ app }}-service"
            port:
              number: 80